components:
  schemas:
    TeamAddition:
      properties:
        teamId:
          type: string
      required:
        - teamId
      example:
        teamId: 55555e555555ee5555e55555

    GameAddition:
      properties:
        start:
          type: date
        finish:
          type: date
        venue_name:
          type: string
        game_location:
          type: object
          properties:
            type:
              type: string
            coordinates:
              type: array
              items:
                type: integer
        team1_id:
          type: string
        team2_id:
          type: string
      required:
        - start
        - finish
        - venue_name
        - game_location
        - team1_id
        - team2_id
      example:
        start: '2021-08-12T10:00:00.000Z'
        finish: '2021-08-12T11:00:00.000Z'
        venue_name: 'Joshua SENPAl Stadium'
        game_location:
          type: 'Point'
          coordinates:
            - 123.456
            - 88.666
        team1_id: '55555e555555ee5555e55555'
        team2_id: '66666e555555ee5555e44444'

    GradeNotFoundResponse:
      allOf:
        - $ref: '#/components/schemas/GenericErrorResponse'
      example:
        success: false
        error: 'Grade does not exist'

paths:
  /grade/{gradeId}:
    get:
      tags:
        - 'Grade'
      summary: 'Find grade by id.'
      parameters:
      - name: 'gradeId'
        in: 'path'
        description: 'ID of grade to return.'
        required: true
        type: 'string'
      responses:
        '200':
          description: 'Successfully found a grade.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
              example:
                success: true
                data:
                  difficulty: E
                  gender: female
                  teams: []
                  _id: 44444d444444dd4444d44444
                  name: Joshua Dubar Grade
                  season: 33333c333333cc3333c33333
                  __v: 0
        '404':
          description: 'Grade does not exist.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GradeNotFoundResponse'

  /grade/{gradeId}/team:
    get:
      tags:
        - 'Grade'
      summary: 'Get all teams for a grade.'
      parameters:
      - name: 'gradeId'
        in: 'path'
        description: 'ID of the grade.'
        required: true
        type: 'string'
      responses:
        '200':
          description: 'Successfully found all teams for a Grade.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
              example:
                success: true
                data:
                  teams:
                    - 55555e555555ee5555e55555
        '404':
          description: 'Grade does not exist.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GradeNotFoundResponse'
    post:
      tags:
        - 'Grade'
      summary: 'Add a team to a grade.'
      description: 'This can only be done by a logged in user and a league admin.'
      parameters:
      - name: 'gradeId'
        in: 'path'
        description: 'ID of the grade.'
        required: true
        type: 'string'
      security:
      - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TeamAddition'
      responses:
        '200':
          description: 'Successfully added a team to a grade.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
              example:
                success: true
                data:
                  difficulty: E
                  gender: female
                  teams: [55555e555555ee5555e55555]
                  _id: 44444d444444dd4444d44444
                  name: Joshua Dubar Grade
                  season: 33333c333333cc3333c33333
                  __v: 0
        '400':
          description: 'Team already exists in a grade for the season.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericErrorResponse'
              example:
                success: false
                error: 'Team already exists in a grade for the season'
        '404':
          description: 'Team does not exist.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TeamNotFoundResponse'
        '403':
          description: 'User is not an admin for this team.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserNotTeamAdminResponse'

  /grade/{gradeId}/round:
    post:
      tags:
        - 'Grade'
      summary: 'Create a new round in a grade.'
      description: 'This can only be done by a logged in user and a league admin.'
      parameters:
      - name: 'gradeId'
        in: 'path'
        description: 'ID of the grade.'
        required: true
        type: 'string'
      security:
      - BearerAuth: []
      responses:
        '201':
          description: 'Successfully created a new round.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
              example:
                success: true
                data:
                  _id: 613c39999910f3519e888821
                  grade: 613c32222222222193333331
                  games: []

        '404':
          description: 'Grade does not exist.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GradeNotFoundResponse'

  /grade/{gradeId}/game:
    post:
      tags:
        - 'Grade'
      summary: 'Add a game to a grade.'
      description: 'This can only be done by a logged in user and a league admin.'
      parameters:
      - name: 'gradeId'
        in: 'path'
        description: 'ID of the grade.'
        required: true
        type: 'string'
      security:
      - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GameAddition'
      responses:
        '201':
          description: 'Successfully created a game.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
              example:
                success: true
                data:
                  _id: 613c36928910f3519e79caf1
                  dateFinish: '2021-08-12T11:00:00.000Z'
                  dateStart: '2021-08-12T10:00:00.000Z'
                  location:
                    coordinates:
                      - 123.456
                      - 88.666
                    type: 'Point'
                  locationName: Joshua SENPAl Stadium
                  status: upcoming
                  team1:
                    playerStats: []
                    team: 613c2f66ff82a7c1c95020ad
                  team2:
                    playerStats: []
                    team: 613c35978910f3519e79cae0
        '404':
          description: 'Team does not exist.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TeamNotFoundResponse'

  /grade/{gradeId}/game/{gameId}:
    patch:
      tags:
        - 'Grade'
      summary: 'Update a game within a grade.'
      description: 'This can only be done by a logged in user and a league admin.'
      parameters:
      - name: 'gradeId'
        in: 'path'
        description: 'ID of the grade.'
        required: true
        type: 'string'
      - name: 'gameId'
        in: 'path'
        description: 'ID of the game.'
        required: true
        type: 'string'
      security:
      - BearerAuth: []  
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GameUpdate'
      responses:
        '200':
          description: 'Successfully updated game.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
              example:
                success: true
                data: asdf
        '404':
          description: 'Team does not exist.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericErrorResponse'
              examples:
                gradeNotFound:
                  value:
                    success: false
                    error: 'Grade does not exist'
                gameNotFound:
                  value:
                    success: false
                    error: 'Game does not exist'
