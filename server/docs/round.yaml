components:
  schemas:
    RoundNotFoundResponse:
      allOf:
        - $ref: '#/components/schemas/GenericErrorResponse'
      example:
        success: false
        error: 'Round does not exist'

    GameAddition:
      properties:
        start:
          type: date
        finish:
          type: date
        venue_name:
          type: string
        game_location:
          type: object
          properties:
            type:
              type: string
            coordinates:
              type: array
              items:
                type: integer
        team1_id:
          type: string
        team2_id:
          type: string
      required:
        - start
        - finish
        - venue_name
        - game_location
        - team1_id
        - team2_id
      example:
        start: '2021-08-12T10:00:00.000Z'
        finish: '2021-08-12T11:00:00.000Z'
        venue_name: 'Joshua SENPAl Stadium'
        game_location:
          type: 'Point'
          coordinates:
            - 123.456
            - 88.666
        team1_id: '55555e555555ee5555e55555'
        team2_id: '66666e555555ee5555e44444'

    GameUpdate:
      properties:
        team1:
          type: object
        team2:
          type: object
      example:
        team1:
          613c5cbea0a3d4e46b70d821:
            points: 69
            assists: 3
        team2:
          613c5ccea0a3d4e46b70d826:
            points: 44
            assists: 0


paths:
  /round/{roundId}:
    get:
      tags:
        - 'Round'
      summary: 'Find round by id.'
      parameters:
      - name: 'roundId'
        in: 'path'
        description: 'ID of round to return.'
        required: true
        type: 'string'
      responses:
        '200':
          description: 'Successfully found a round.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
              example:
                success: true
                data:
                  games: []
                  grade: 6138a18dbe9bc3b701dec788
                  _id: 613c51ca9ba1acc1926855e8
        '404':
          description: 'Round does not exist.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RoundNotFoundResponse'

  /round/{roundId}/game/{gameId}:
    get:
      tags:
        - 'Round'
      summary: 'Find game by id.'
      parameters:
      - name: 'roundId'
        in: 'path'
        description: 'ID of the round.'
        required: true
        type: 'string'
      - name: 'gameId'
        in: 'path'
        description: 'ID of the game.'
        required: true
        type: 'string'
      responses:
        '200':
          description: 'Successfully found a game.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
              example:
                success: true
                data:
                  _id: 613c36928910f3519e79caf1
                  dateFinish: '2021-08-12T11:00:00.000Z'
                  dateStart: '2021-08-12T10:00:00.000Z'
                  location:
                    coordinates:
                      - 123.456
                      - 88.666
                    type: 'Point'
                  locationName: Josh Dubz Stadium
                  status: upcoming
                  team1:
                    playerStats: []
                    team: 613c2f66ff82a7c1c95020ad
                  team2:
                    playerStats: []
                    team: 613c35978910f3519e79cae0
        '404':
          description: 'Game does not exist.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericErrorResponse'
              examples:
                roundNotFound:
                  value:
                    success: false
                    error: 'Round does not exist'
                gameNotFound:
                  value:
                    success: false
                    error: 'Game does not exist'

  /round/{roundId}/game:
    post:
      tags:
        - 'Round'
      summary: 'Add a game to a round.'
      description: 'This can only be done by a logged in user and a league admin.'
      parameters:
      - name: 'roundId'
        in: 'path'
        description: 'ID of the round.'
        required: true
        type: 'string'
      security:
      - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GameAddition'
      responses:
        '201':
          description: 'Successfully created a game.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
              example:
                success: true
                data:
                  _id: 613c36928910f3519e79caf1
                  dateFinish: '2021-08-12T11:00:00.000Z'
                  dateStart: '2021-08-12T10:00:00.000Z'
                  location:
                    coordinates:
                      - 123.456
                      - 88.666
                    type: 'Point'
                  locationName: Joshua SENPAl Stadium
                  status: upcoming
                  team1:
                    playerStats: []
                    team: 613c2f66ff82a7c1c95020ad
                  team2:
                    playerStats: []
                    team: 613c35978910f3519e79cae0
        '404':
          description: 'Team does not exist.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TeamNotFoundResponse'


  /round/{roundId}/game/{gameId}:
    patch:
      tags:
        - 'Round'
      summary: 'Update a game within a round.'
      description: 'This can only be done by a logged in user and a league admin.'
      parameters:
      - name: 'roundId'
        in: 'path'
        description: 'ID of the round.'
        required: true
        type: 'string'
      - name: 'gameId'
        in: 'path'
        description: 'ID of the game.'
        required: true
        type: 'string'
      security:
      - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/GameUpdate'
      responses:
        '200':
          description: 'Successfully updated game.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
              example:
                success: true
                data:
                  team: 6138a1a7be9bc3b701dec78c
                  _id: 613c614411b24a676c401429
                  dateFinish: '2021-08-12T11:00:00.000Z'
                  dateStart: '2021-08-12T10:00:00.000Z'
                  location:
                    coordinates:
                      - 123.456
                      - 88.666
                    type: Point
                  locationName: Joshua SENPAl Stadium
                  team1:
                    team: 6138a1f8be9bc3b701dec7a1
                    playersStats:
                      - _id: 613c61a5c9138b8534eacf9f
                        playerId: 613c5cbea0a3d4e46b70d821
                        points: 69
                        assists: 3
                      - _id: 613c61a5c9138b8534eacfa3
                        playerId: 613c5ccea0a3d4e46b70d826
                        points: 44
                        assists: 0
        '404':
          description: 'Team does not exist.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenericErrorResponse'
              examples:
                roundNotFound:
                  value:
                    success: false
                    error: 'Round does not exist'
                gameNotFound:
                  value:
                    success: false
                    error: 'Game does not exist'
                playerNotFound:
                  value:
                    success: false
                    error: 'Player does not exist'
